#include <vector>
#include <string>
#include <iostream>
#include <sstream>
#include <algorithm>
using namespace std;


class Solution {
public:
    vector<int> countMentions(int numberOfUsers, vector<vector<string>>& events) {
        
        struct Ev { long long t; int typeOrder; int idx; string type; string arg; };
        vector<Ev> evs;
        evs.reserve(events.size());
        for (int i = 0; i < (int)events.size(); ++i) {
            string typ = events[i][0];
            long long t = stoll(events[i][1]);
            string arg = events[i][2];
            int order = (typ == "OFFLINE") ? 0 : 1; 
            evs.push_back({t, order, i, typ, arg});
        }
        sort(evs.begin(), evs.end(), [](const Ev& a, const Ev& b) {
            if (a.t != b.t) return a.t < b.t;
            if (a.typeOrder != b.typeOrder) return a.typeOrder < b.typeOrder;
            return a.idx < b.idx;
        });

        vector<int> mentions(numberOfUsers, 0);
        vector<bool> online(numberOfUsers, true);            
        vector<long long> recover(numberOfUsers, 0);        

        for (const auto &e : evs) {
            long long t = e.t;
           
            for (int u = 0; u < numberOfUsers; ++u) {
                if (!online[u] && recover[u] <= t) online[u] = true;
            }

            if (e.type == "OFFLINE") {
                int uid = stoi(e.arg);    
                online[uid] = false;
                recover[uid] = t + 60;   
            } else { 
                istringstream ss(e.arg);
                string token;
                while (ss >> token) {
                    if (token == "ALL") {
                        for (int u = 0; u < numberOfUsers; ++u) mentions[u] += 1;
                    } else if (token == "HERE") {
                        for (int u = 0; u < numberOfUsers; ++u)
                            if (online[u]) mentions[u] += 1;
                    } else if (token.rfind("id", 0) == 0) { 
                        int uid = stoi(token.substr(2));
                        mentions[uid] += 1;
                    }
                }
            }
        }

        return mentions;
    }
};

int main() {
    Solution sol;
    int numberOfUsers = 3;
    vector<vector<string>> events = {
        {"MENTION", "1", "id0 id1"},
        {"OFFLINE", "2", "1"},
        {"MENTION", "3", "HERE"},
        {"MENTION", "62", "ALL"},
        {"MENTION", "63", "id1"}
    };
    vector<int> result = sol.countMentions(numberOfUsers, events);
    for (int count : result) {
        cout << count << " ";
    }
    cout << endl; // Output: 3 2 2
    return 0;
};